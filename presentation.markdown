<!-- .slide: data-background="var(--microsoft-blue)" -->

# Azure, serverless

---

## serverless

---

## <del>serverless</del>
less servers

note:
* â†˜ de config, de gestion
* managÃ©
* focus sur le code

---

## serveurs  ?

note:
* c^ dÃ©ployer une application
* je gÃ¨re, je m'occupe

---

## on premise
* hardware <!-- .element: class="fragment" -->

note:
* avantages vs. inconvÃ©nients
* pannes matÃ©rielles
* rÃ©seau (firewall, fai)

---

## iaas
* <del>hardware</del>
* os <!-- .element: class="fragment" -->

note:
* pannes logicielles
* mises Ã  jour

---

## paas
* <del>hardware</del>
* <del>os</del>
* framework <!-- .element: class="fragment" -->

note:
* montÃ©es de version
* archi logicielles (bases, messaging, etc.)
* scalabilitÃ©

---

## faas
* <del>hardware</del> 
* <del>os</del>
* <del>framework</del>
* function <!-- .element: class="fragment" -->

note:
* code

---

## faas ?
* Azure functions âš¡ <!-- .element: class="fragment" -->
* Google functions <!-- .element: class="fragment" -->
* AWS lambda <!-- .element: class="fragment" -->

note:
* sous-partie de serverless
* open faas

---

## âš¡ functions 
* event-driven <!-- .element: class="fragment" -->

note:
* microsoft
* dÃ©clencheur = Ã©vÃ©nement
* ecosystÃ¨me Azure

---

## âš¡ functions
* event-driven
* infinite scaling

note:
* vs vm prÃ©-provisionnÃ©e
* load balancer
* eg black-friday

---

## todo
schÃ©ma montÃ©e charge vm

---


## todo
schÃ©ma montÃ©e charge serverless

---

## âš¡ functions
* event-driven
* infinite scaling 
* pay as you go <!-- .element: class="fragment" -->

note:
* 1 million d'exÃ©cutions gratuites
* 0 exÃ©cution = 0â‚¬
* exemple uat, testing

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# use cases

---

## api http
* microservices <!-- .element: class="fragment" -->
* web hooks <!-- .element: class="fragment" -->

note:
* Ã©vÃ©nement = requÃªte http

---

```typescript <!-- .element: class="fragment" -->
@FunctionName("hello")
public HttpResponseMessage run(
    @HttpTrigger(name = "req", methods = HttpMethod.GET }, authLevel = AuthorizationLevel.ANONYMOUS)
    HttpRequestMessage<Optional<String>> request,
    final ExecutionContext context) {

    context.getLogger().info("Java HTTP trigger processed a request.");

    String name = request.getQueryParameters().get("name");

    return request.createResponseBuilder(HttpStatus.OK).body("Hello, " + name).build();
}
```

---

```typescript
@FunctionName("hello")
public HttpResponseMessage run(
    @HttpTrigger(name = "req", methods = {HttpMethod.GET}, authLevel = AuthorizationLevel.ANONYMOUS,
        route = "trigger/{id}/{name=EMPTY}")
    HttpRequestMessage<Optional<String>> request,
    @BindingName("id") String id,
    @BindingName("name") String name,
    final ExecutionContext context) {

    // ...

}
```

---

```csharp
[FunctionName("hello")]
public static async Task<IActionResult> Run(
    [HttpTrigger(AuthorizationLevel.Anonymous, "get", Route = null)] 
    HttpRequest req, ILogger log)
{
    log.LogInformation("C# HTTP trigger function processed a request.");

    string name = req.Query["name"];

    return new OkObjectResult($"Hello, {name}");;
}
```

---

## todo
screenshot mvn run

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
* utilisez les bindings ğŸ’¡ <!-- .element: class="fragment" -->
* utilisez les triggers ğŸ’¡ <!-- .element: class="fragment" -->

---

## api http
back-end pour une spa ? <!-- .element: class="fragment" -->

note:
* API crÃ©Ã© rapidement

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
utilisez function proxy ğŸ’¡ <!-- .element: class="fragment" -->

---

## todo
screenshot function proxy ğŸ’¡

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
utilisez static web storage ğŸ’¡ <!-- .element: class="fragment" -->

---

## todo
screenshot static web storage ğŸ’¡

---

## api http
loterie bons de rÃ©duction <!-- .element: class="fragment" -->

note:
* != full serverless/microservices ğŸ’¡
* un fonctionnalitÃ© avec bcp de trafic ?

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# use cases

---

## event sourcing pt. 1

note:
* volumÃ©trie non connues Ã  l'avance

---

## todo
schÃ©ma event sourcing

---

## todo
exemple trigger service bus (c#)

---

## event sourcing pt. 2
rÃ©agir aux update de resources Azure <!-- .element: class="fragment" -->

---

## todo
* exemple resource bdd (nodejs)
* entrÃ©e et sortie

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->


## tip
* utilisez les bindings ğŸ’¡
* utilisez les triggers ğŸ’¡

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# opiniated framework

note:
* dÃ©clarations simplifiÃ©es

---

## Ã©vÃ©nements = triggers
* http / webhooks <!-- .element: class="fragment" -->
* bus de messages <!-- .element: class="fragment" -->
* bases de donnÃ©es <!-- .element: class="fragment" -->
* scheduler <!-- .element: class="fragment" -->
* etc. <!-- .element: class="fragment" -->

---

## resources = bindings
* bus de messages <!-- .element: class="fragment" -->
* bases de donnÃ©es <!-- .element: class="fragment" -->
* key vault <!-- .element: class="fragment" -->
* Azure AD <!-- .element: class="fragment" -->

---

## langages
c# , java, javascript, python, powershell <!-- .element: class="fragment" -->

note:
* c# et javascript ++
* vs autres faas

---

## attributes ou annotations
* triggers et bindings  <!-- .element: class="fragment" -->
* c# et java <!-- .element: class="fragment" -->

note:
* sinon function.json

---

## ğŸŒŸ ioc
todo

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
ddd ğŸ’¡ <!-- .element: class="fragment" -->

note:
* sÃ©parer logique mÃ©tier

--- 

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

# avantages

---

## configuration simplifiÃ©e
* function.json <!-- .element: class="fragment" -->
* variables d'environnement <!-- .element: class="fragment" -->
* ğŸŒŸ Azure key vault <!-- .element: class="fragment" -->

---

## en local
* Azure functions tools (cli) ğŸ’¡ <!-- .element: class="fragment" -->
* VS / VS code <!-- .element: class="fragment" -->
* maven <!-- .element: class="fragment" -->
* emulateurs <!-- .element: class="fragment" -->

note:
* != autres faas
* Cosmos DB
* resources Azure ? service bus ?

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

# inconvÃ©nients 

---

## stateless

note:
* liÃ© au framework
* contournable ğŸ¤” (durable functions, cache partagÃ©) 
* exemple id vs pays

---

## durÃ©e limitÃ©e

note:
* 10 min max par exÃ©cution

---

## cold start

note:
* conteneurs, c^ orchestrateur
* Ã  la demande / Ã©teint si inactif
* billing
* qq secondes, en thÃ©orie ğŸ’¡

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip 
adapter sa stratÃ©gie ğŸ’¡ <!-- .element: class="fragment" -->

note:
* polling 
* Azure front door
* ğŸŒŸ functions premium


---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip 
utiliser l'effet cache ğŸ’¡ <!-- .element: class="fragment" -->

---

```csharp
public class MyFunction
{
    private static ServiceWithCostlyStartup service = ...

} 
```

---

## manquent...
* healthcheck ğŸ’¡ <!-- .element: class="fragment" -->
* swagger ğŸ’¡ <!-- .element: class="fragment" -->

note:
* swagger first / swagger manuel

---

## networking
* ğŸŒŸ VNET / ASE ğŸ’¡ <!-- .element: class="fragment" -->
* DNS <!-- .element: class="fragment" -->

---

## pricing

note:
* avoir une idÃ©e de la volumÃ©trie

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# ecosystÃ¨me

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
utilisez application insights ğŸ’¡ <!-- .element: class="fragment" -->

---

<!-- .slide:  data-background="var(--microsoft-green)" class="tip" -->

## tip
* templates arm ğŸ’¡ <!-- .element: class="fragment" -->
* Azure devops <!-- .element: class="fragment" -->
* ğŸŒŸ job functions <!-- .element: class="fragment" -->

note:
* deploy depuis poste local 

---

## durable functions
* orchestration <!-- .element: class="fragment" -->
* ğŸŒŸ durable entities <!-- .element: class="fragment" -->
---

## logic apps 

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# merci

---

<!-- .slide: data-background="var(--microsoft-blue)" -->

# ğŸ’¬
